---
title: "Lab 06 - Ugly charts and Simpson's paradox"
author: "Insert your name here"
date: "Insert date here"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox)
library(mosaicData) 
```

```{r}
staff <- read_csv("data/instructional-staff.csv")
```
```{r}
staff_long <- staff %>%
  pivot_longer(cols = -faculty_type, names_to = "year") %>%
  mutate(value = as.numeric(value))
```

```{r}
staff_long %>%
  mutate(
    year = as.numeric(year),
    value = as.numeric(value),
    faculty_type = as.factor(faculty_type)
  ) %>%
  ggplot(aes(
    x = year,
    y = value,
    group = faculty_type,
    color = faculty_type
  )) +
  geom_line(size = 1) +
  labs(
    title = "Number of Employted Faculty Types (1975-2011)",
    x = "Year",
    y = "Number of Faculty",
    color = "Faculty Type"
  ) +
  theme_minimal()
```

2. I feel as if as the graph is already showing that the number of part time faculty is going up compared to other faculty types; in fact, it is the only one showing an upward trend.

3. Regarding how the data visualization can be improved:
 - The graph can be zoomed in so the representation is clearer
 - The "Aquaculture" data visualization can be made to be like the "Capture" data visualization, such that it is easier to see the bars of little value.

Other than these fixes (both of which I do not know how to implement), I think the graph and data visualizations look fine as they are.

### Exercise 1

These data were likely obtained from an observational study. I assume that the researchers kept track of each individual's life for a certain amount of time and recorded the data accordingly. Though it does seem fairly unreasonable to do so for a long amount of time and for so many people, based on the data provided, my guess is it is observational

### Exercise 2
There are 1314 observations, each of which represents one individual smoker.

### Exercise 3
There are three variables: whether the individual is alive or dead, whether they were a smoker, and their age.

## Exercise 4
I would that if an individual is a smoker, there health is poorer, or vice versa.

## Exercise 5
```{r}
ggplot(Whickham, aes(x = smoker, fill = outcome)) +
  geom_bar(position = "fill") +
  labs(
    y = "Percentage",
    x = "Smoking Status",
    fill = "Health Outcome",
    title = "Relationsihp Between Smoking Status and Health"
  ) +
  theme_minimal()
```

These results did not meet my expectations since there is a higher death rate for individuals who do not smoke (27%) than for those who do (24%) However, it has been proven that smoking leads to a lower life expectancy, so I am guessing that of those who are dead and were not smokers, some other confounding variable such as disease or murder is a contributing factor. These results would lead you to believe smoking makes little difference in whether you die younger or not, but I would conclude that they are inaccurate regardless.

## Exercise 6
```{r}
Whickham <- Whickham %>%
  mutate(
    age_cat = case_when(
      age <= 44 ~ "18-44",
      age > 44 & age <= 64 ~ "45-64",
      age > 64 ~ "65+"
    )
  )
```

## Exercise 7
```{r}
Whickham %>%
  ggplot(aes(x = smoker, fill = outcome)) +
  geom_bar(position = "fill") +
  facet_wrap(~ age_cat) +
  labs(
    y = "Percentage",
    x = "Smoking Status",
    fill = "Health Outcome",
    title = "Relationship Between Smoking and Health By Age"
  ) +
  theme_minimal()
```
As opposed to the previous graph, this plot seems to show that overall, individuals who smoked ended up having a higher death rate than those who did not. One possible contributing factor is that individuals who are younger are likely to have not died as they are generally healthier than older individuals, hence the 18-44 age group was skewing the data.

```{r}
Whickham %>%
  count(age_cat, smoker, outcome) %>%
  group_by(age_cat, smoker) %>%
  mutate(prop = n / sum(n))
```
